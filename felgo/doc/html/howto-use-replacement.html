<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- sdlgfx-port.qdoc -->
  <title>Chapter 5: How to use the SDL_gfx-like drop-in replacement | felgo-neurocid</title>
</head>
<body>
<div class="sidebar"><div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Chapter 5: How to use the SDL_gfx-like drop-in replacement</h1>
<span class="subtitle"></span>
<!-- $$$howto_use_replacement.html-description -->
<div class="descr"> <a name="details"></a>
<p>The following code shows an example of how to use the API we created. You can find the full implementation in main.cpp</p>
<pre class="cpp"><span class="comment">//A common felgo boiler-plate</span>
<span class="type">QApplication</span> app(argc<span class="operator">,</span> argv);
FelgoApplication felgo;
<span class="type">QQmlApplicationEngine</span> engine;
felgo<span class="operator">.</span>initialize(<span class="operator">&amp;</span>engine);

<span class="comment">//load main qml file</span>
felgo<span class="operator">.</span>setMainQmlFileName(<span class="type">QStringLiteral</span>(<span class="string">&quot;qml/GfxCanvasExample.qml&quot;</span>));
engine<span class="operator">.</span>load(<span class="type">QUrl</span>(felgo<span class="operator">.</span>mainQmlFileName()));

<span class="comment">//find the gfxCanvas QML object by the objectName we assigned in Chapter 3</span>
<span class="type">QObject</span> <span class="operator">*</span>qmlGfxCanvas <span class="operator">=</span> rootObjs<span class="operator">.</span>first()<span class="operator">-</span><span class="operator">&gt;</span>findChild<span class="operator">&lt;</span><span class="type">QObject</span><span class="operator">*</span><span class="operator">&gt;</span>(<span class="string">&quot;gfxCanvas&quot;</span>);

std<span class="operator">::</span>thread gameThread(<span class="operator">[</span><span class="operator">=</span><span class="operator">]</span>() {
    <span class="comment">//wait for the GfxCanvas to become available</span>
    <span class="keyword">while</span>(<span class="operator">!</span>qmlGfxCanvas<span class="operator">-</span><span class="operator">&gt;</span>property(<span class="string">&quot;available&quot;</span>)<span class="operator">.</span>toBool()) {
        std<span class="operator">::</span>this_thread<span class="operator">::</span>sleep_for(std<span class="operator">::</span>chrono<span class="operator">::</span>milliseconds(<span class="number">100</span>));
        std<span class="operator">::</span>cerr <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">&quot;wait&quot;</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> std<span class="operator">::</span>endl;
    }

    <span class="comment">//Instantiate our C++ to QML bridge.</span>
    FelgoGFX<span class="operator">*</span> felgoGfx <span class="operator">=</span> <span class="keyword">new</span> nc<span class="operator">::</span>FelgoGFX(qmlGfxCanvas);

    <span class="keyword">while</span>(<span class="keyword">true</span>) {
        <span class="comment">//fill the canvas black</span>
        felgoGfx<span class="operator">.</span>clear(<span class="number">0</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">0</span>)
        <span class="comment">//draw a line</span>
        felgoGfx<span class="operator">.</span>lineRGBA(<span class="number">0</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">100</span><span class="operator">,</span><span class="number">100</span><span class="operator">,</span><span class="number">255</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">255</span>);
        <span class="comment">//display what we have drawn</span>
        felgoGfx<span class="operator">.</span>flip();
    }
});

gameThread<span class="operator">.</span>detach();

<span class="comment">//now that everything is setup, run the felgo applications</span>
<span class="keyword">return</span> app<span class="operator">.</span>exec();</pre>
</div>
<!-- @@@howto_use_replacement.html -->
</body>
</html>
